<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>autotier: folly::WaitOptions::Defaults Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">autotier
   </div>
   <div id="projectbrief">Automatic Tiering Fuse Filesystem</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>folly</b></li><li class="navelem"><a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a></li><li class="navelem"><a class="el" href="structfolly_1_1WaitOptions_1_1Defaults.html">Defaults</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="structfolly_1_1WaitOptions_1_1Defaults-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">folly::WaitOptions::Defaults Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:ac760f7decbc4aa8601006b7d3f574beb"><td class="memItemLeft" align="right" valign="top">static constexpr std::chrono::nanoseconds&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfolly_1_1WaitOptions_1_1Defaults.html#ac760f7decbc4aa8601006b7d3f574beb">spin_max</a></td></tr>
<tr class="separator:ac760f7decbc4aa8601006b7d3f574beb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac760f7decbc4aa8601006b7d3f574beb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac760f7decbc4aa8601006b7d3f574beb">&#9670;&nbsp;</a></span>spin_max</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr std::chrono::nanoseconds folly::WaitOptions::Defaults::spin_max</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">        std::chrono::microseconds(2)</div>
</div><!-- fragment --><p>spin_max</p>
<p>If multiple threads are actively using a synchronization primitive, whether indirectly via a higher-level concurrent data structure or directly, where the synchronization primitive has an operation which waits and another operation which wakes the waiter, it is common for wait and wake events to happen almost at the same time. In this state, we lose big 50% of the time if the wait blocks immediately.</p>
<p>We can improve our chances of being waked immediately, before blocking, by spinning for a short duration, although we have to balance this against the extra cpu utilization, latency reduction, power consumption, and priority inversion effect if we end up blocking anyway.</p>
<p>We use a default maximum of 2 usec of spinning. As partial consolation, since spinning as implemented in folly uses the pause instruction where available, we give a small speed boost to the colocated hyperthread.</p>
<p>On circa-2013 devbox hardware, it costs about 7 usec to FUTEX_WAIT and then be awoken. Spins on this hw take about 7 nsec, where all but 0.5 nsec is the pause instruction. </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following files:<ul>
<li>src/rocksdb/third-party/folly/folly/synchronization/<a class="el" href="WaitOptions_8h_source.html">WaitOptions.h</a></li>
<li>src/rocksdb/third-party/folly/folly/synchronization/WaitOptions.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
