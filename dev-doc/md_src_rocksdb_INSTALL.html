<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>autotier: Compilation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">autotier
   </div>
   <div id="projectbrief">Automatic Tiering Fuse Filesystem</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Compilation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Important</b>: If you plan to run RocksDB in production, don't compile using default <code>make</code> or <code>make all</code>. That will compile RocksDB in debug mode, which is much slower than release mode.</p>
<p>RocksDB's library should be able to compile without any dependency installed, although we recommend installing some compression libraries (see below). We do depend on newer gcc/clang with C++11 support.</p>
<p>There are few options when compiling RocksDB:</p>
<ul>
<li>[recommended] <code>make static_lib</code> will compile librocksdb.a, RocksDB static library. Compiles static library in release mode.</li>
<li><code>make shared_lib</code> will compile librocksdb.so, RocksDB shared library. Compiles shared library in release mode.</li>
<li><code>make check</code> will compile and run all the unit tests. <code>make check</code> will compile RocksDB in debug mode.</li>
<li><code>make all</code> will compile our static library, and all our tools and unit tests. Our tools depend on gflags. You will need to have gflags installed to run <code>make all</code>. This will compile RocksDB in debug mode. Don't use binaries compiled by <code>make all</code> in production.</li>
<li>By default the binary we produce is optimized for the platform you're compiling on (<code>-march=native</code> or the equivalent). SSE4.2 will thus be enabled automatically if your CPU supports it. To print a warning if your CPU does not support SSE4.2, build with <code>USE_SSE=1 make static_lib</code> or, if using CMake, <code>cmake -DFORCE_SSE42=ON</code>. If you want to build a portable binary, add <code>PORTABLE=1</code> before your make commands, like this: <code>PORTABLE=1 make static_lib</code>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md703"></a>
Dependencies</h1>
<ul>
<li>You can link RocksDB with following compression libraries:<ul>
<li><a href="http://www.zlib.net/">zlib</a> - a library for data compression.</li>
<li><a href="http://www.bzip.org/">bzip2</a> - a library for data compression.</li>
<li><a href="https://github.com/lz4/lz4">lz4</a> - a library for extremely fast data compression.</li>
<li><a href="http://google.github.io/snappy/">snappy</a> - a library for fast data compression.</li>
<li><a href="http://www.zstd.net">zstandard</a> - Fast real-time compression algorithm.</li>
</ul>
</li>
<li>All our tools depend on:<ul>
<li><a href="https://gflags.github.io/gflags/">gflags</a> - a library that handles command line flags processing. You can compile rocksdb library even if you don't have gflags installed.</li>
</ul>
</li>
<li><code>make check</code> will also check code formatting, which requires <a href="https://clang.llvm.org/docs/ClangFormat.html">clang-format</a></li>
<li>If you wish to build the RocksJava static target, then cmake is required for building Snappy.</li>
</ul>
<h1><a class="anchor" id="autotoc_md704"></a>
Supported platforms</h1>
<ul>
<li><b>Linux - Ubuntu</b><ul>
<li>Upgrade your gcc to version at least 4.8 to get C++11 support.</li>
<li>Install gflags. First, try: <code>sudo apt-get install libgflags-dev</code> If this doesn't work and you're using Ubuntu, here's a nice tutorial: (<a href="http://askubuntu.com/questions/312173/installing-gflags-12-04">http://askubuntu.com/questions/312173/installing-gflags-12-04</a>)</li>
<li>Install snappy. This is usually as easy as: <code>sudo apt-get install libsnappy-dev</code>.</li>
<li>Install zlib. Try: <code>sudo apt-get install zlib1g-dev</code>.</li>
<li>Install bzip2: <code>sudo apt-get install libbz2-dev</code>.</li>
<li>Install lz4: <code>sudo apt-get install liblz4-dev</code>.</li>
<li>Install zstandard: <code>sudo apt-get install libzstd-dev</code>.</li>
</ul>
</li>
<li><b>Linux - CentOS / RHEL</b><ul>
<li>Upgrade your gcc to version at least 4.8 to get C++11 support: <code>yum install gcc48-c++</code></li>
<li><p class="startli">Install gflags: </p><pre class="fragment">    git clone https://github.com/gflags/gflags.git
    cd gflags
    git checkout v2.0
    ./configure &amp;&amp; make &amp;&amp; sudo make install
</pre><p class="startli"><b>Notice</b>: Once installed, please add the include path for gflags to your <code>CPATH</code> environment variable and the lib path to <code>LIBRARY_PATH</code>. If installed with default settings, the include path will be <code>/usr/local/include</code> and the lib path will be <code>/usr/local/lib</code>.</p>
</li>
<li>Install snappy: <pre class="fragment">    sudo yum install snappy snappy-devel
</pre></li>
<li>Install zlib: <pre class="fragment">    sudo yum install zlib zlib-devel
</pre></li>
<li>Install bzip2: <pre class="fragment">    sudo yum install bzip2 bzip2-devel
</pre></li>
<li>Install lz4: <pre class="fragment">    sudo yum install lz4-devel
</pre></li>
<li>Install ASAN (optional for debugging): <pre class="fragment">    sudo yum install libasan
</pre></li>
<li>Install zstandard:<ul>
<li>With <a href="https://fedoraproject.org/wiki/EPEL">EPEL</a>: <pre class="fragment">sudo yum install libzstd-devel
</pre></li>
<li>With CentOS 8: <pre class="fragment">sudo dnf install libzstd-devel
</pre></li>
<li>From source: <pre class="fragment">wget https://github.com/facebook/zstd/archive/v1.1.3.tar.gz
mv v1.1.3.tar.gz zstd-1.1.3.tar.gz
tar zxvf zstd-1.1.3.tar.gz
cd zstd-1.1.3
make &amp;&amp; sudo make install
</pre></li>
</ul>
</li>
</ul>
</li>
<li><b>OS X</b>:<ul>
<li>Install latest C++ compiler that supports C++ 11:<ul>
<li>Update XCode: run <code>xcode-select --install</code> (or install it from XCode App's settting).</li>
<li>Install via <a href="http://brew.sh/">homebrew</a>.<ul>
<li>If you're first time developer in MacOS, you still need to run: <code>xcode-select --install</code> in your command line.</li>
<li>run <code>brew tap homebrew/versions; brew install gcc48 --use-llvm</code> to install gcc 4.8 (or higher).</li>
</ul>
</li>
</ul>
</li>
<li>run <code>brew install rocksdb</code></li>
</ul>
</li>
<li><b>FreeBSD</b> (11.01):<ul>
<li>You can either install RocksDB from the Ports system using <code>cd /usr/ports/databases/rocksdb &amp;&amp; make install</code>, or you can follow the details below to install dependencies and compile from source code:</li>
<li><p class="startli">Install the dependencies for RocksDB:</p>
<p class="startli">export BATCH=YES cd /usr/ports/devel/gmake &amp;&amp; make install cd /usr/ports/devel/gflags &amp;&amp; make install</p>
<p class="startli">cd /usr/ports/archivers/snappy &amp;&amp; make install cd /usr/ports/archivers/bzip2 &amp;&amp; make install cd /usr/ports/archivers/liblz4 &amp;&amp; make install cd /usr/ports/archivesrs/zstd &amp;&amp; make install</p>
<p class="startli">cd /usr/ports/devel/git &amp;&amp; make install</p>
</li>
</ul>
</li>
</ul>
<pre class="fragment">* Install the dependencies for RocksJava (optional):

    export BATCH=yes
    cd /usr/ports/java/openjdk7 &amp;&amp; make install

* Build RocksDB from source:
    cd ~
    git clone https://github.com/facebook/rocksdb.git
    cd rocksdb
    gmake static_lib

* Build RocksJava from source (optional):
    cd rocksdb
    export JAVA_HOME=/usr/local/openjdk7
    gmake rocksdbjava
</pre><ul>
<li><b>OpenBSD</b> (6.3/-current):<ul>
<li>As RocksDB is not available in the ports yet you have to build it on your own:</li>
<li><p class="startli">Install the dependencies for RocksDB:</p>
<p class="startli">pkg_add gmake gflags snappy bzip2 lz4 zstd git jdk bash findutils gnuwatch</p>
</li>
<li><p class="startli">Build RocksDB from source:</p>
<p class="startli">cd ~ git clone <a href="https://github.com/facebook/rocksdb.git">https://github.com/facebook/rocksdb.git</a> cd rocksdb gmake static_lib</p>
</li>
<li><p class="startli">Build RocksJava from source (optional):</p>
<p class="startli">cd rocksdb export JAVA_HOME=/usr/local/jdk-1.8.0 export PATH=$PATH:/usr/local/jdk-1.8.0/bin gmake rocksdbjava</p>
</li>
</ul>
</li>
<li><b>iOS</b>:<ul>
<li>Run: <code>TARGET_OS=IOS make static_lib</code>. When building the project which uses rocksdb iOS library, make sure to define two important pre-processing macros: <code>ROCKSDB_LITE</code> and <code>IOS_CROSS_COMPILE</code>.</li>
</ul>
</li>
<li><b>Windows</b>:<ul>
<li>For building with MS Visual Studio 13 you will need Update 4 installed.</li>
<li>Read and follow the instructions at CMakeLists.txt</li>
<li>Or install via <a href="https://github.com/microsoft/vcpkg">vcpkg</a><ul>
<li>run <code>vcpkg install rocksdb:x64-windows</code></li>
</ul>
</li>
</ul>
</li>
<li><b>AIX 6.1</b><ul>
<li>Install AIX Toolbox rpms with gcc</li>
<li>Use these environment variables: <pre class="fragment">   export PORTABLE=1
   export CC=gcc
   export AR="ar -X64"
   export EXTRA_ARFLAGS=-X64
   export EXTRA_CFLAGS=-maix64
   export EXTRA_CXXFLAGS=-maix64
   export PLATFORM_LDFLAGS="-static-libstdc++ -static-libgcc"
   export LIBPATH=/opt/freeware/lib
   export JAVA_HOME=/usr/java8_64
   export PATH=/opt/freeware/bin:$PATH
</pre></li>
</ul>
</li>
<li><b>Solaris Sparc</b><ul>
<li>Install GCC 4.8.2 and higher.</li>
<li>Use these environment variables: <pre class="fragment">   export CC=gcc
   export EXTRA_CFLAGS=-m64
   export EXTRA_CXXFLAGS=-m64
   export EXTRA_LDFLAGS=-m64
   export PORTABLE=1
   export PLATFORM_LDFLAGS="-static-libstdc++ -static-libgcc"
</pre> </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
