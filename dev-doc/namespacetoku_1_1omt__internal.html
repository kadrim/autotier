<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>autotier: toku::omt_internal Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">autotier
   </div>
   <div id="projectbrief">Automatic Tiering Fuse Filesystem</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>toku</b></li><li class="navelem"><a class="el" href="namespacetoku_1_1omt__internal.html">omt_internal</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">toku::omt_internal Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtoku_1_1omt__internal_1_1omt__node__templated.html">omt_node_templated</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtoku_1_1omt__internal_1_1omt__node__templated_3_01omtdata__t_00_01true_01_4.html">omt_node_templated&lt; omtdata_t, true &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtoku_1_1omt__internal_1_1subtree__templated.html">subtree_templated</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtoku_1_1omt__internal_1_1subtree__templated_3_01true_01_4.html">subtree_templated&lt; true &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ff647b67cdd1b6f9844bdf15baa8231"><td class="memTemplParams" colspan="2"><a id="a0ff647b67cdd1b6f9844bdf15baa8231"></a>
template&lt;bool subtree_supports_marks&gt; </td></tr>
<tr class="memitem:a0ff647b67cdd1b6f9844bdf15baa8231"><td class="memTemplItemLeft" align="right" valign="top">class <a class="el" href="classtoku_1_1omt__internal_1_1subtree__templated.html">toku::omt_internal::subtree_templated</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><b>__attribute__</b> ((__packed__, aligned(4)))</td></tr>
<tr class="separator:a0ff647b67cdd1b6f9844bdf15baa8231"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a442b176253a8d424cbf77725f573a4fe"><td class="memItemLeft" align="right" valign="top"><a id="a442b176253a8d424cbf77725f573a4fe"></a>
template&lt;&gt; </td></tr>
<tr class="memitem:a442b176253a8d424cbf77725f573a4fe"><td class="memTemplItemLeft" align="right" valign="top">class <a class="el" href="classtoku_1_1omt__internal_1_1subtree__templated.html">toku::omt_internal::subtree_templated</a>&lt; true &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>__attribute__</b> ((__packed__))</td></tr>
<tr class="separator:a442b176253a8d424cbf77725f573a4fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9d9a91a7b8a420caf2508c7ab3b90b67"><td class="memItemLeft" align="right" valign="top"><a id="a9d9a91a7b8a420caf2508c7ab3b90b67"></a>
class <a class="el" href="classtoku_1_1omt__internal_1_1omt__node__templated.html">toku::omt_internal::omt_node_templated</a>&#160;</td><td class="memItemRight" valign="bottom"><b>__attribute__</b></td></tr>
<tr class="separator:a9d9a91a7b8a420caf2508c7ab3b90b67"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Order Maintenance Tree (OMT)</p>
<p>Maintains a collection of totally ordered values, where each value has an integer weight. The OMT is a mutable datatype.</p>
<p>The Abstraction:</p>
<p>An OMT is a vector of values, $V$, where $|V|$ is the length of the vector. The vector is numbered from $0$ to $|V|-1$. Each value has a weight. The weight of the $i$th element is denoted $w(V_i)$.</p>
<p>We can create a new OMT, which is the empty vector.</p>
<p>We can insert a new element $x$ into slot $i$, changing $V$ into $V'$ where $|V'|=1+|V|$ and</p>
<p>V'<em>j = V_j if $j&lt;i$ x if $j=i$ V</em>{j-1} if $j&gt;i$.</p>
<p>We can specify $i$ using a kind of function instead of as an integer. Let $b$ be a function mapping from values to nonzero integers, such that the signum of $b$ is monotically increasing. We can specify $i$ as the minimum integer such that $b(V_i)&gt;0$.</p>
<p>We look up a value using its index, or using a Heaviside function. For lookups, we allow $b$ to be zero for some values, and again the signum of $b$ must be monotonically increasing. When lookup up values, we can look up $V_i$ where $i$ is the minimum integer such that $b(V_i)=0$. (With a special return code if no such value exists.) (Rationale: Ordinarily we want $i$ to be unique. But for various reasons we want to allow multiple zeros, and we want the smallest $i$ in that case.) $V_i$ where $i$ is the minimum integer such that $b(V_i)&gt;0$. (Or an indication that no such value exists.) $V_i$ where $i$ is the maximum integer such that $b(V_i)&lt;0$. (Or an indication that no such value exists.)</p>
<p>When looking up a value using a Heaviside function, we get the value and its index.</p>
<p>We can also split an OMT into two OMTs, splitting the weight of the values evenly. Find a value $j$ such that the values to the left of $j$ have about the same total weight as the values to the right of $j$. The resulting two OMTs contain the values to the left of $j$ and the values to the right of $j$ respectively. All of the values from the original OMT go into one of the new OMTs. If the weights of the values don't split exactly evenly, then the implementation has the freedom to choose whether the new left OMT or the new right OMT is larger.</p>
<p>Performance: Insertion and deletion should run with $O(\log |V|)$ time and $O(\log |V|)$ calls to the Heaviside function. The memory required is O(|V|).</p>
<p>Usage: The omt is templated by two parameters:</p><ul>
<li>omtdata_t is what will be stored within the omt. These could be pointers or real data types (ints, structs).</li>
<li>omtdataout_t is what will be returned by find and related functions. By default, it is the same as omtdata_t, but you can set it to (omtdata_t *). To create an omt which will store "TXNID"s, for example, it is a good idea to typedef the template: typedef <a class="el" href="classtoku_1_1omt.html">omt&lt;TXNID&gt;</a> txnid_omt_t; If you are storing structs, you may want to be able to get a pointer to the data actually stored in the omt (see find_zero). To do this, use the second template parameter: typedef omt&lt;struct foo, struct foo *&gt; foo_omt_t; </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
